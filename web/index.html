<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的项目管理系统</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- 顶部导航栏 -->
    <header class="header">
        <div class="container">
            <h1 class="logo">我的项目管理系统</h1>
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="showStats()">统计信息</button>
                <button class="btn btn-secondary" onclick="openOpsModal()">运维</button>
                <button class="btn btn-primary" onclick="showAddProjectModal()">添加项目</button>
            </div>
        </div>
    </header>

    <!-- 主内容区域 -->
    <main class="main-content">
        <div class="container">
            <!-- 筛选区域 -->
            <div class="filters">
                <div class="filter-group">
                    <label for="statusFilter">状态筛选：</label>
                    <select id="statusFilter" onchange="applyFilters()">
                        <option value="">全部状态</option>
                        <option value="planning">计划中</option>
                        <option value="in-progress">进行中</option>
                        <option value="paused">暂停</option>
                        <option value="completed">已完成</option>
                        <option value="cancelled">已取消</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="priorityFilter">优先级筛选：</label>
                    <select id="priorityFilter" onchange="applyFilters()">
                        <option value="">全部优先级</option>
                        <option value="low">低</option>
                        <option value="medium">中</option>
                        <option value="high">高</option>
                        <option value="urgent">紧急</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="sortMode">排序：</label>
                    <select id="sortMode" onchange="applySortMode()">
                        <option value="manual" selected>手动拖拽</option>
                        <option value="priority">按优先级</option>
                    </select>
                </div>
            </div>

            <!-- 项目列表 -->
            <div id="projectsList" class="projects-table">
            </div>

            <!-- 加载中提示 -->
            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>加载中...</p>
            </div>

            <!-- 空状态提示 -->
            <div id="emptyState" class="empty-state" style="display: none;">
                <p>还没有项目，点击"添加项目"开始吧！</p>
            </div>
        </div>
    </main>

    <!-- 添加/编辑项目模态框 -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">添加项目</h2>
                <button class="close-btn" onclick="closeProjectModal()">&times;</button>
            </div>
            <form id="projectForm" onsubmit="saveProject(event)">
                <div class="form-group">
                    <label for="projectName">项目名称 <span class="required">*</span></label>
                    <input type="text" id="projectName" required>
                </div>
                <div class="form-group">
                    <label for="projectDescription">项目描述</label>
                    <textarea id="projectDescription" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="projectStatus">状态</label>
                        <select id="projectStatus">
                            <option value="planning">计划中</option>
                            <option value="in-progress">进行中</option>
                            <option value="paused">暂停</option>
                            <option value="completed">已完成</option>
                            <option value="cancelled">已取消</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="projectPriority">优先级</label>
                        <select id="projectPriority">
                            <option value="low">低</option>
                            <option value="medium" selected>中</option>
                            <option value="high">高</option>
                            <option value="urgent">紧急</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="projectProgress">进度 (%)</label>
                        <input type="number" id="projectProgress" min="0" max="100" value="0">
                    </div>
                    <div class="form-group">
                        <label for="projectCostTotal">成本（已花费，元）</label>
                        <input type="number" id="projectCostTotal" min="0" step="0.01" value="0">
                    </div>
                </div>
                <div class="form-group">
                    <label for="projectRevenueTotal">收入（目前收入，元）</label>
                    <input type="number" id="projectRevenueTotal" min="0" step="0.01" value="0">
                </div>
                <div class="form-group">
                    <label for="projectGithub">Github 仓库</label>
                    <input type="text" id="projectGithub" placeholder="如: https://github.com/user/repo">
                </div>
                <div class="form-group">
                    <label for="projectWorkspace">工作目录</label>
                    <input type="text" id="projectWorkspace" placeholder="如: E:/Projects/MyProject">
                </div>
                <div class="form-group">
                    <label for="projectNotes">备注</label>
                    <textarea id="projectNotes" rows="2"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeProjectModal()">取消</button>
                    <button type="submit" class="btn btn-primary">保存</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 项目详情模态框 -->
    <div id="projectDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>项目详情</h2>
                <button class="close-btn" onclick="closeProjectDetailModal()">&times;</button>
            </div>
            <div id="projectDetailContent" class="stats-content"></div>
        </div>
    </div>

    <!-- 统计信息模态框 -->
    <div id="statsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>统计信息</h2>
                <button class="close-btn" onclick="closeStatsModal()">&times;</button>
            </div>
            <div id="statsContent" class="stats-content">
                <!-- 统计内容将通过JavaScript动态生成 -->
            </div>
        </div>
    </div>

    <!-- 运维模态框 -->
    <div id="opsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>运维</h2>
                <button class="close-btn" onclick="closeOpsModal()">&times;</button>
            </div>
            <div class="stats-content">
                <div class="form-group">
                    <label for="opsToken">管理口令（PM_ADMIN_TOKEN）</label>
                    <input type="password" id="opsToken" placeholder="在服务器上设置 PM_ADMIN_TOKEN 后使用">
                </div>
                <div id="opsDeployStatus" class="ops-status ops-status-idle">未开始部署</div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="opsPushData()">Push 数据到数据仓库</button>
                    <button type="button" class="btn btn-secondary" onclick="opsPullRestart()">拉取更新并重启</button>
                    <button type="button" class="btn btn-secondary" onclick="opsStartDeployLog()">实时日志</button>
                    <button type="button" class="btn btn-secondary" onclick="opsStopDeployLog()">停止日志</button>
                </div>
                <pre id="opsOutput" class="ops-output"></pre>
            </div>
        </div>
    </div>

    <!-- Toast 提示 -->
    <div id="toast" class="toast"></div>

    <script src="js/app.js"></script>
</body>
</html>
