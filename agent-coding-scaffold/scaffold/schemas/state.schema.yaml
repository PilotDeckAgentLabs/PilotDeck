schema_version: 1
title: state
type: object
required:
  - schema_version
  - execution
  - sync
properties:
  schema_version:
    type: integer
    enum: [1]
  execution:
    type: object
    required: [run_status, active_step_id, last_checkpoint, blockers, next_actions]
    properties:
      run_status:
        type: string
        enum: [running, success, failed, cancelled]
      active_step_id:
        type: string
      last_checkpoint:
        type: string
      blockers:
        type: array
        items:
          type: string
      next_actions:
        type: array
        items:
          type: string
  sync:
    type: object
    required: [mode, last_sync_result, remote_ids, errors]
    properties:
      mode:
        type: string
        enum: [local_only, remote_preferred, remote_required]
      last_sync_result:
        type: string
        enum: [not_started, success, partial, failed]
      last_sync_checkpoint:
        anyOf:
          - type: "null"
          - type: string
      remote_ids:
        type: object
        required: [project_id, run_id, event_id]
        properties:
          project_id:
            anyOf:
              - type: "null"
              - type: string
          run_id:
            anyOf:
              - type: "null"
              - type: string
          event_id:
            anyOf:
              - type: "null"
              - type: string
      errors:
        type: array
        items:
          type: string
